<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"><title>Transpilation – Lightning CSS</title><link rel="icon" href="rust-less/favicon.3aabf677.svg"><link rel="mask-icon" href="rust-less/favicon.3aabf677.svg" color="#f9bb03"><meta name="description" content="An extremely fast CSS parser, transformer, bundler, and minifier."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="rust-less/og.jpeg"><meta name="twitter:site" content="@lightningcss"><meta name="twitter:creator" content="@lightningcss"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://lightningcss.dev/transpilation.html"><meta property="og:title" content="Transpilation – Lightning CSS"><meta property="og:description" content="An extremely fast CSS parser, transformer, bundler, and minifier."><meta property="og:image" content="rust-less/og.jpeg"><link rel="stylesheet" href="rust-less/bundling.523e9a32.css"></head><body> <header> <svg viewBox="495 168 360 654"><path class="outer" d="M594.41 805c-.71 0-1.43-.15-2.11-.47a5.015 5.015 0 0 1-2.72-5.83l67.98-253.71H517.11a5.03 5.03 0 0 1-4.44-2.69c-.86-1.65-.73-3.65.34-5.18l26.85-38.35q25.56-36.51 104.91-149.83l106.31-151.82a4.991 4.991 0 0 1 6.21-1.66 5.015 5.015 0 0 1 2.72 5.83L692.03 455h140.45c1.86 0 3.57 1.04 4.43 2.69.86 1.65.73 3.65-.34 5.18l-238.07 340a5.006 5.006 0 0 1-4.1 2.13Zm-67.69-270h137.37c1.55 0 3.02.72 3.97 1.96.95 1.23 1.27 2.84.86 4.34l-62.33 232.61 216.29-308.9H685.52c-1.55 0-3.02-.72-3.97-1.96a4.966 4.966 0 0 1-.86-4.34l62.33-232.61-90.04 128.59q-79.35 113.32-104.91 149.83L526.73 535Z"/><path class="inner" d="M594.41 805c-.71 0-1.43-.15-2.11-.47a5.015 5.015 0 0 1-2.72-5.83l67.98-253.71H517.11a5.03 5.03 0 0 1-4.44-2.69c-.86-1.65-.73-3.65.34-5.18l26.85-38.35q25.56-36.51 104.91-149.83l106.31-151.82a4.991 4.991 0 0 1 6.21-1.66 5.015 5.015 0 0 1 2.72 5.83L692.03 455h140.45c1.86 0 3.57 1.04 4.43 2.69.86 1.65.73 3.65-.34 5.18l-238.07 340a5.006 5.006 0 0 1-4.1 2.13Zm-67.69-270h137.37c1.55 0 3.02.72 3.97 1.96.95 1.23 1.27 2.84.86 4.34l-62.33 232.61 216.29-308.9H685.52c-1.55 0-3.02-.72-3.97-1.96a4.966 4.966 0 0 1-.86-4.34l62.33-232.61-90.04 128.59q-79.35 113.32-104.91 149.83L526.73 535Z"/></svg> <a href="/" class="title">Lightning CSS</a> <p><a href="rust-less/playground/index.html">Playground</a> • <a href="rust-less/docs.html">Docs</a> • <a href="https://docs.rs/lightningcss" target="_blank">Rust docs</a> • <a href="https://npmjs.com/lightningcss" target="_blank">npm</a> • <a href="https://github.com/parcel-bundler/lightningcss" target="_blank">GitHub</a></p> </header> <nav> <h3>Docs</h3> <ul> <li><a href="rust-less/docs.html">Getting started</a></li> <li><a href="rust-less/transpilation.html">Transpilation</a></li> <li><a href="rust-less/css-modules.html">CSS Modules</a></li> <li><a href="rust-less/bundling.html">Bundling</a></li> <li><a href="rust-less/minification.html">Minification</a></li> <li><a href="rust-less/transforms.html">Custom transforms</a></li> <script>document.querySelector(`nav a[href="${location.pathname}"]`).setAttribute("aria-current","page");</script> </ul> </nav> <main> <aside> <p></p><div class="table-of-contents"><h3>On this page</h3><ul><li><a href="#browser-targets">Browser targets</a><ul><li><a href="#cli">CLI</a></li><li><a href="#feature-flags">Feature flags</a></li></ul></li><li><a href="#vendor-prefixing">Vendor prefixing</a></li><li><a href="#syntax-lowering">Syntax lowering</a><ul><li><a href="#nesting">Nesting</a></li><li><a href="#color-mix">Color mix</a></li><li><a href="#relative-colors">Relative colors</a></li><li><a href="#lab-colors">LAB colors</a></li><li><a href="#color-function">Color function</a></li><li><a href="#hwb-colors">HWB colors</a></li><li><a href="#color-notation">Color notation</a></li><li><a href="#logical-properties">Logical properties</a></li><li><a href="#%3Adir()-selector">:dir() selector</a></li><li><a href="#%3Alang()-selector">:lang() selector</a></li><li><a href="#%3Ais()-selector">:is() selector</a></li><li><a href="#%3Anot()-selector">:not() selector</a></li><li><a href="#math-functions">Math functions</a></li><li><a href="#media-query-ranges">Media query ranges</a></li><li><a href="#shorthands">Shorthands</a></li><li><a href="#double-position-gradients">Double position gradients</a></li><li><a href="#system-ui-font">system-ui font</a></li></ul></li><li><a href="#draft-syntax">Draft syntax</a><ul><li><a href="#custom-media-queries">Custom media queries</a></li></ul></li><li><a href="#pseudo-class-replacement">Pseudo class replacement</a></li><li><a href="#non-standard-syntax">Non-standard syntax</a></li></ul></div><p></p> </aside> <h1 id="transpilation" tabindex="-1">Transpilation</h1> <p>Lightning CSS includes support for transpiling modern CSS syntax to support older browsers, including vendor prefixing and syntax lowering.</p> <h2 id="browser-targets" tabindex="-1">Browser targets</h2> <p>By default Lightning CSS does not perform any transpilation of CSS syntax for older browsers. This means that if you write your code using modern syntax or without vendor prefixes, that’s what Lightning CSS will output. You can declare your app’s supported browsers using the <code>targets</code> option. When this is declared, Lightning CSS will transpile your code accordingly to ensure compatibility with your supported browsers.</p> <p>Targets are defined using an object that specifies the minimum version of each browser you want to support. The easiest way to build a targets object is to use <a href="https://browserslist.dev">browserslist</a>. This lets you use a query that automatically updates over time as new browser versions are released, market share changes, etc. The following example will return a targets object listing browsers with &gt;= 0.25% market share.</p> <pre class="language-js"><code class="language-js"><span class="keyword token">import</span> browserslist <span class="keyword token">from</span> <span class="string token">'browserslist'</span><span class="punctuation token">;</span>
<span class="keyword token">import</span> <span class="punctuation token">{</span> transform<span class="punctuation token">,</span> browserslistToTargets <span class="punctuation token">}</span> <span class="keyword token">from</span> <span class="string token">'lightningcss'</span><span class="punctuation token">;</span>

<span class="comment token">// Call this once per build.</span>
<span class="keyword token">let</span> targets <span class="operator token">=</span> <span class="function token">browserslistToTargets</span><span class="punctuation token">(</span><span class="function token">browserslist</span><span class="punctuation token">(</span><span class="string token">'>= 0.25%'</span><span class="punctuation token">)</span><span class="punctuation token">)</span><span class="punctuation token">;</span>

<span class="comment token">// Use `targets` for each file you transform.</span>
<span class="keyword token">let</span> <span class="punctuation token">{</span> code<span class="punctuation token">,</span> map <span class="punctuation token">}</span> <span class="operator token">=</span> <span class="function token">transform</span><span class="punctuation token">(</span><span class="punctuation token">{</span>
  <span class="comment token">// ...</span>
  targets
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
</code></pre> <p>For the best performance, you should call browserslist once for your whole build process, and reuse the same <code>targets</code> object when calling <code>transform</code> for each file.</p> <p>Under the hood, <code>targets</code> are represented using an object that maps browser names to minimum versions. Version numbers are represented using a single 24-bit number, with one semver component (major, minor, patch) per byte. For example, this targets object would represent Safari 13.2.0.</p> <pre class="language-js"><code class="language-js"><span class="keyword token">let</span> targets <span class="operator token">=</span> <span class="punctuation token">{</span>
  <span class="literal-property property token">safari</span><span class="operator token">:</span> <span class="punctuation token">(</span><span class="number token">13</span> <span class="operator token">&lt;&lt;</span> <span class="number token">16</span><span class="punctuation token">)</span> <span class="operator token">|</span> <span class="punctuation token">(</span><span class="number token">2</span> <span class="operator token">&lt;&lt;</span> <span class="number token">8</span><span class="punctuation token">)</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span>
</code></pre> <h3 id="cli" tabindex="-1">CLI</h3> <p>When using the CLI, targets can be provided by passing a <a href="https://browserslist.dev">browserslist</a> query to the <code>--targets</code> option. Alternatively, if the <code>--browserslist</code> option is provided, then <code>lightningcss</code> finds browserslist configuration, selects queries by environment and loads the resulting queries as targets.</p> <p>Configuration discovery and targets resolution is modeled after the original <code>browserslist</code> Node package. The configuration is resolved in the following order:</p> <ul> <li>If a <code>BROWSERSLIST</code> environment variable is present, then load targets from its value.</li> <li>If a <code>BROWSERSLIST_CONFIG</code> environment variable is present, then load the browserslist configuration from the file at the provided path.</li> <li>If none of the above apply, then find, parse and use targets from the first <code>browserslist</code>, <code>.browserslistrc</code>, or <code>package.json</code> configuration file in any parent directory.</li> </ul> <p>Browserslist configuration files may contain sections denoted by square brackets. Use these to specify different targets for different environments. Targets which are not placed in a section are added to <code>defaults</code> and used if no section matches the environment.</p> <pre class="language-ini"><code class="language-ini"><span class="comment token"># Defaults, applied when no other section matches the provided environment.</span>
firefox ESR

<span class="comment token"># Targets applied only to the staging environment.</span>
<span class="section token"><span class="punctuation token">[</span><span class="section-name selector token">staging</span><span class="punctuation token">]</span></span>
<span class="attr-name key token">samsung ></span><span class="punctuation token">=</span> <span class="attr-value token value">4</span>
</code></pre> <p>When using parsed configuration from <code>browserslist</code>, <code>.browserslistrc</code>, or <code>package.json</code> configuration files, the environment is determined by:</p> <ul> <li>the <code>BROWSERSLIST_ENV</code> environment variable if present</li> <li>the <code>NODE_ENV</code> environment variable if present</li> <li>otherwise <code>&quot;production&quot;</code> is used.</li> </ul> <p>If no targets are found for the resulting environment, then the <code>defaults</code> configuration section is used.</p> <h3 id="feature-flags" tabindex="-1">Feature flags</h3> <p>In most cases, setting the <code>targets</code> option and letting Lightning CSS automatically compile your CSS works great. However, in other cases you might need a little more control over exactly what features are compiled and which are not. That's where the <code>include</code> and <code>exclude</code> options come in.</p> <p>The <code>include</code> and <code>exclude</code> options allow you to explicitly turn on or off certain features. These override the defaults based on the provided browser targets. For example, you might want to only compile colors, and handle auto prefixing or other features with another tool. Or you may want to handle everything except vendor prefixing with Lightning CSS. These options make that possible.</p> <p>The <code>include</code> and <code>exclude</code> options are configured using the <code>Features</code> enum, which can be imported from <code>lightningcss</code>. You can bitwise OR multiple flags together to turn them on or off.</p> <pre class="language-js"><code class="language-js"><span class="keyword token">import</span> <span class="punctuation token">{</span> transform<span class="punctuation token">,</span> Features <span class="punctuation token">}</span> <span class="keyword token">from</span> <span class="string token">'lightningcss'</span><span class="punctuation token">;</span>

<span class="keyword token">let</span> <span class="punctuation token">{</span> code<span class="punctuation token">,</span> map <span class="punctuation token">}</span> <span class="operator token">=</span> <span class="function token">transform</span><span class="punctuation token">(</span><span class="punctuation token">{</span>
  <span class="comment token">// ...</span>
  targets<span class="punctuation token">,</span>
  <span class="comment token">// Always compile colors and CSS nesting, regardless of browser targets.</span>
  <span class="literal-property property token">include</span><span class="operator token">:</span> Features<span class="punctuation token">.</span>Colors <span class="operator token">|</span> Features<span class="punctuation token">.</span>Nesting<span class="punctuation token">,</span>
  <span class="comment token">// Never add any vendor prefixes, regardless of targets.</span>
  <span class="literal-property property token">exclude</span><span class="operator token">:</span> Features<span class="punctuation token">.</span>VendorPrefixes
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
</code></pre> <p>Here is a full list of available flags, described in the sections below:</p> <div class="features"> <ul> <li><code>Nesting</code></li> <li><code>NotSelectorList</code></li> <li><code>DirSelector</code></li> <li><code>LangSelectorList</code></li> <li><code>IsSelector</code></li> <li><code>TextDecorationThicknessPercent</code></li> <li><code>MediaIntervalSyntax</code></li> <li><code>MediaRangeSyntax</code></li> <li><code>CustomMediaQueries</code></li> <li><code>ClampFunction</code></li> <li><code>ColorFunction</code></li> <li><code>OklabColors</code></li> <li><code>LabColors</code></li> <li><code>P3Colors</code></li> <li><code>HexAlphaColors</code></li> <li><code>SpaceSeparatedColorNotation</code></li> <li><code>FontFamilySystemUi</code></li> <li><code>DoublePositionGradients</code></li> <li><code>VendorPrefixes</code></li> <li><code>LogicalProperties</code></li> <li><code>Selectors</code> – shorthand for <code>Nesting | NotSelectorList | DirSelector | LangSelectorList | IsSelector</code></li> <li><code>MediaQueries</code> – shorthand for <code>MediaIntervalSyntax | MediaRangeSyntax | CustomMediaQueries</code></li> <li><code>Colors</code> – shorthand for <code>ColorFunction | OklabColors | LabColors | P3Colors | HexAlphaColors | SpaceSeparatedColorNotation</code></li> </ul> </div> <h2 id="vendor-prefixing" tabindex="-1">Vendor prefixing</h2> <p>Based on your configured browser targets, Lightning CSS automatically adds vendor prefixed fallbacks for many CSS features. For example, when using the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/image/image-set()"><code>image-set()</code></a> function, Lightning CSS will output a fallback <code>-webkit-image-set()</code> value as well, since Chrome does not yet support the unprefixed value.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.logo</span> <span class="punctuation token">{</span>
  <span class="property token">background</span><span class="punctuation token">:</span> <span class="function token">image-set</span><span class="punctuation token">(</span><span class="token url"><span class="function token">url</span><span class="punctuation token">(</span>logo.png<span class="punctuation token">)</span></span> 2x<span class="punctuation token">,</span> <span class="token url"><span class="function token">url</span><span class="punctuation token">(</span>logo.png<span class="punctuation token">)</span></span> 1x<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.logo</span> <span class="punctuation token">{</span>
  <span class="property token">background</span><span class="punctuation token">:</span> <span class="function token">-webkit-image-set</span><span class="punctuation token">(</span><span class="token url"><span class="function token">url</span><span class="punctuation token">(</span>logo.png<span class="punctuation token">)</span></span> 2x<span class="punctuation token">,</span> <span class="token url"><span class="function token">url</span><span class="punctuation token">(</span>logo.png<span class="punctuation token">)</span></span> 1x<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="property token">background</span><span class="punctuation token">:</span> <span class="function token">image-set</span><span class="punctuation token">(</span><span class="string token">"logo.png"</span> 2x<span class="punctuation token">,</span> <span class="string token">"logo.png"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>In addition, if your CSS source code (or more likely a library) includes unnecessary vendor prefixes, Lightning CSS will automatically remove them to reduce bundle sizes. For example, when compiling for modern browsers, prefixed versions of the <code>transition</code> property will be removed, since the unprefixed version is supported by all browsers.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.button</span> <span class="punctuation token">{</span>
  <span class="property token">-webkit-transition</span><span class="punctuation token">:</span> background 200ms<span class="punctuation token">;</span>
  <span class="property token">-moz-transition</span><span class="punctuation token">:</span> background 200ms<span class="punctuation token">;</span>
  <span class="property token">transition</span><span class="punctuation token">:</span> background 200ms<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>becomes:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.button</span> <span class="punctuation token">{</span>
  <span class="property token">transition</span><span class="punctuation token">:</span> background .2s<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h2 id="syntax-lowering" tabindex="-1">Syntax lowering</h2> <p>Lightning CSS automatically compiles many modern CSS syntax features to more compatible output that is supported in your target browsers.</p> <h3 id="nesting" tabindex="-1">Nesting</h3> <p>The <a href="https://drafts.csswg.org/css-nesting/">CSS Nesting</a> spec enables style rules to be nested, with the selectors of the child rules extending the parent selector in some way. This is very commonly supported by CSS pre-processors like Sass, but with this spec, it will eventually be supported natively in browsers. Lightning CSS compiles this syntax to un-nested style rules that are supported in all browsers today.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> blue<span class="punctuation token">;</span>

  <span class="selector token">.bar</span> <span class="punctuation token">{</span>
    <span class="property token">color</span><span class="punctuation token">:</span> red<span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <p>is equivalent to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> blue<span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="selector token">.foo .bar</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> red<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p><a href="https://drafts.csswg.org/css-nesting/#conditionals">Conditional rules</a> such as <code>@media</code> may also be nested within a style rule, without repeating the selector. For example:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">display</span><span class="punctuation token">:</span> grid<span class="punctuation token">;</span>

  <span class="atrule token"><span class="rule token">@media</span> <span class="punctuation token">(</span><span class="property token">orientation</span><span class="punctuation token">:</span> landscape<span class="punctuation token">)</span></span> <span class="punctuation token">{</span>
    <span class="property token">grid-auto-flow</span><span class="punctuation token">:</span> column<span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <p>is equivalent to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">display</span><span class="punctuation token">:</span> grid<span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="atrule token"><span class="rule token">@media</span> <span class="punctuation token">(</span><span class="property token">orientation</span><span class="punctuation token">:</span> landscape<span class="punctuation token">)</span></span> <span class="punctuation token">{</span>
  <span class="selector token">.foo</span> <span class="punctuation token">{</span>
    <span class="property token">grid-auto-flow</span><span class="punctuation token">:</span> column<span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="color-mix" tabindex="-1">Color mix</h3> <p>The <a href="https://drafts.csswg.org/css-color-5/#color-mix"><code>color-mix()</code></a> function allows you to mix two colors by the specified amount in a certain color space. Lightning CSS will evaluate this function statically when all components are known (i.e. not variables).</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">color-mix</span><span class="punctuation token">(</span>in hsl<span class="punctuation token">,</span> <span class="function token">hsl</span><span class="punctuation token">(</span>120deg 10% 20%<span class="punctuation token">)</span> 25%<span class="punctuation token">,</span> <span class="function token">hsl</span><span class="punctuation token">(</span>30deg 30% 40%<span class="punctuation token">)</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> #706a43<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="relative-colors" tabindex="-1">Relative colors</h3> <p>Relative colors allow you to modify the components of a color using math functions. In addition, you can convert colors between color spaces. Lightning CSS performs these calculations statically when all components are known (i.e. not variables).</p> <p>This example lightens <code>slateblue</code> by 10% in the LCH color space.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">lch</span><span class="punctuation token">(</span>from slateblue <span class="function token">calc</span><span class="punctuation token">(</span>l + 10%<span class="punctuation token">)</span> c h<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">lch</span><span class="punctuation token">(</span>54.5711% 65.7776 296.794<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="lab-colors" tabindex="-1">LAB colors</h3> <p>Lightning CSS will convert <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/lab()"><code>lab()</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/lch()"><code>lch()</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/oklab"><code>oklab()</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/oklch"><code>oklch()</code></a> colors to fallback values for unsupported browsers when needed. These functions allow you to define colors in higher gamut color spaces, making it possible to use colors that cannot be represented by RGB.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">lab</span><span class="punctuation token">(</span>40% 56.6 39<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> #b32323<span class="punctuation token">;</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">color</span><span class="punctuation token">(</span>display-p3 .643308 .192455 .167712<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">lab</span><span class="punctuation token">(</span>40% 56.6 39<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>As shown above, a <code>display-p3</code> fallback is included in addition to RGB when a target browser supports the P3 color space. This preserves high color gamut colors when possible.</p> <h3 id="color-function" tabindex="-1">Color function</h3> <p>Lightning CSS converts the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/color()"><code>color()</code></a> function to RGB when needed for compatibility with older browsers. This allows you to use predefined color spaces such as <code>display-p3</code>, <code>xyz</code>, and <code>a98-rgb</code>.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">color</span><span class="punctuation token">(</span>a98-rgb 0.44091 0.49971 0.37408<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">background-color</span><span class="punctuation token">:</span> #6a805d<span class="punctuation token">;</span>
  <span class="property token">background-color</span><span class="punctuation token">:</span> <span class="function token">color</span><span class="punctuation token">(</span>a98-rgb .44091 .49971 .37408<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="hwb-colors" tabindex="-1">HWB colors</h3> <p>Lightning CSS converts <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/hwb"><code>hwb()</code></a> colors to RGB.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">hwb</span><span class="punctuation token">(</span>194 0% 0%<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> #00c4ff<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="color-notation" tabindex="-1">Color notation</h3> <p>Space separated color notation is converted to hex when needed. Hex colors with alpha are also converted to <code>rgba()</code> when unsupported by all targets.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> #7bffff80<span class="punctuation token">;</span>
  <span class="property token">background</span><span class="punctuation token">:</span> <span class="function token">rgb</span><span class="punctuation token">(</span>123 255 255<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> <span class="function token">rgba</span><span class="punctuation token">(</span>123<span class="punctuation token">,</span> 255<span class="punctuation token">,</span> 255<span class="punctuation token">,</span> .5<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="property token">background</span><span class="punctuation token">:</span> #7bffff<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="logical-properties" tabindex="-1">Logical properties</h3> <p>CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Logical_Properties">logical properties</a> allow you to define values in terms of writing direction, so that UIs mirror in right-to-left languages. Lightning CSS will compile these to use the <code>:dir()</code> selector when unsupported. If the <code>:dir()</code> selector is unsupported, it is compiled as described <a href="#%3Adir()-selector">below</a>.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">border-start-start-radius</span><span class="punctuation token">:</span> 20px
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo:dir(ltr)</span> <span class="punctuation token">{</span>
  <span class="property token">border-top-left-radius</span><span class="punctuation token">:</span> 20px<span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="selector token">.foo:dir(rtl)</span> <span class="punctuation token">{</span>
  <span class="property token">border-top-right-radius</span><span class="punctuation token">:</span> 20px<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="%3Adir()-selector" tabindex="-1">:dir() selector</h3> <p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:dir"><code>:dir()</code></a> selector matches elements based on the writing direction. Lightning CSS compiles this to use the <code>:lang()</code> selector when unsupported, which approximates this behavior as closely as possible.</p> <pre class="language-css"><code class="language-css"><span class="selector token">a:dir(rtl)</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span>red
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">a:lang(ae, ar, arc, bcc, bqi, ckb, dv, fa, glk, he, ku, mzn, nqo, pnb, ps, sd, ug, ur, yi)</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> red<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>If multiple arguments to <code>:lang()</code> are unsupported, it is compiled as described <a href="#%3Alang()-selector">below</a>.</p> <h3 id="%3Alang()-selector" tabindex="-1">:lang() selector</h3> <p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:lang"><code>:lang()</code></a> selector matches elements based on their language. Some browsers do not support multiple arguments to this function, so Lightning CSS compiles them to use <code>:is()</code> when needed.</p> <pre class="language-css"><code class="language-css"><span class="selector token">a:lang(en, fr)</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span>red
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">a:is(:lang(en), :lang(fr))</span> <span class="punctuation token">{</span>
  <span class="property token">color</span><span class="punctuation token">:</span> red<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>When the <code>:is()</code> selector is unsupported, it is compiled as described <a href="#%3Ais()-selector">below</a>.</p> <h3 id="%3Ais()-selector" tabindex="-1">:is() selector</h3> <p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:is"><code>:is()</code></a> matches when one of its arguments matches. Lightning CSS falls back to the <code>:-webkit-any</code> and <code>:-moz-any</code> prefixed selectors.</p> <pre class="language-css"><code class="language-css"><span class="selector token">p:is(:first-child, .lead)</span> <span class="punctuation token">{</span>
  <span class="property token">margin-top</span><span class="punctuation token">:</span> 0<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">p:-webkit-any(:first-child, .lead)</span> <span class="punctuation token">{</span>
  <span class="property token">margin-top</span><span class="punctuation token">:</span> 0<span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="selector token">p:-moz-any(:first-child, .lead)</span> <span class="punctuation token">{</span>
  <span class="property token">margin-top</span><span class="punctuation token">:</span> 0<span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="selector token">p:is(:first-child, .lead)</span> <span class="punctuation token">{</span>
  <span class="property token">margin-top</span><span class="punctuation token">:</span> 0<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <div class="warning"> <p><strong>Note</strong>: The prefixed versions of these selectors do not support complex selectors (e.g. selectors with combinators). Lightning CSS will only output prefixes if the arguments are simple selectors. Complex selectors in <code>:is()</code> are not currently compiled.</p> </div> <h3 id="%3Anot()-selector" tabindex="-1">:not() selector</h3> <p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:not"><code>:not()</code></a> selector can accept multiple arguments, and matches if none of the arguments match. Some older browsers only support a single argument, so Lightning CSS compiles this when needed. The <code>:is</code> selector is used to ensure the specificity remains the same, with fallback to <code>-webkit-any</code> and <code>-moz-any</code> as needed (described above).</p> <pre class="language-css"><code class="language-css"><span class="selector token">p:not(:first-child, .lead)</span> <span class="punctuation token">{</span>
  <span class="property token">margin-top</span><span class="punctuation token">:</span> 1em<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">p:not(:is(:first-child, .lead))</span> <span class="punctuation token">{</span>
  <span class="property token">margin-top</span><span class="punctuation token">:</span> 1em<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="math-functions" tabindex="-1">Math functions</h3> <p>Lightning CSS simplifies <a href="https://w3c.github.io/csswg-drafts/css-values/#math">math functions</a> including <code>clamp()</code>, <code>round()</code>, <code>rem()</code>, <code>mod()</code>, <code>abs()</code>, and <code>sign()</code>, <a href="https://w3c.github.io/csswg-drafts/css-values/#trig-funcs">trigonometric functions</a> including <code>sin()</code>, <code>cos()</code>, <code>tan()</code>, <code>asin()</code>, <code>acos()</code>, <code>atan()</code>, and <code>atan2()</code>, and <a href="https://w3c.github.io/csswg-drafts/css-values/#exponent-funcs">exponential functions</a> including <code>pow()</code>, <code>log()</code>, <code>sqrt()</code>, <code>exp()</code>, and <code>hypot()</code> when all arguments are known (i.e. not variables). In addition, the numeric constants <code>e</code>, <code>pi</code>, <code>infinity</code>, <code>-infinity</code>, and <code>NaN</code> are supported in all calculations.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">width</span><span class="punctuation token">:</span> <span class="function token">round</span><span class="punctuation token">(</span><span class="function token">calc</span><span class="punctuation token">(</span>100px * <span class="function token">sin</span><span class="punctuation token">(</span>pi / 4<span class="punctuation token">)</span><span class="punctuation token">)</span><span class="punctuation token">,</span> 5px<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">width</span><span class="punctuation token">:</span> 70px<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="media-query-ranges" tabindex="-1">Media query ranges</h3> <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries#syntax_improvements_in_level_4">Media query range syntax</a> allows defining media queries using comparison operators to create ranges and intervals. Lightning CSS compiles this to the corresponding <code>min</code> and <code>max</code> media features when needed.</p> <pre class="language-css"><code class="language-css"><span class="atrule token"><span class="rule token">@media</span> <span class="punctuation token">(</span>480px &lt;= width &lt;= 768px<span class="punctuation token">)</span></span> <span class="punctuation token">{</span>
  <span class="selector token">.foo</span> <span class="punctuation token">{</span> <span class="property token">color</span><span class="punctuation token">:</span> red <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="atrule token"><span class="rule token">@media</span> <span class="punctuation token">(</span><span class="property token">min-width</span><span class="punctuation token">:</span> 480px<span class="punctuation token">)</span> <span class="keyword token">and</span> <span class="punctuation token">(</span><span class="property token">max-width</span><span class="punctuation token">:</span> 768px<span class="punctuation token">)</span></span> <span class="punctuation token">{</span>
  <span class="selector token">.foo</span> <span class="punctuation token">{</span> <span class="property token">color</span><span class="punctuation token">:</span> red <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="shorthands" tabindex="-1">Shorthands</h3> <p>Lightning CSS compiles the following shorthands to corresponding longhands when the shorthand is not supported in all target browsers:</p> <ul> <li>Alignment shorthands: <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/place-items">place-items</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/place-content">place-content</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/place-self">place-self</a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/overflow">Overflow shorthand</a> with multiple values (e.g. <code>overflow: hidden auto</code>)</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-decoration">text-decoration</a> with thickness, style, color, etc.</li> <li>Two value <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/display">display</a> syntax (e.g. <code>display: inline flex</code>)</li> </ul> <h3 id="double-position-gradients" tabindex="-1">Double position gradients</h3> <p>CSS gradients support using two positions in a color stop to repeat the color at two subsequent positions. When unsupported, Lightning CSS compiles it.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">background</span><span class="punctuation token">:</span> <span class="function token">linear-gradient</span><span class="punctuation token">(</span>green<span class="punctuation token">,</span> red 30% 40%<span class="punctuation token">,</span> pink<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">background</span><span class="punctuation token">:</span> <span class="function token">linear-gradient</span><span class="punctuation token">(</span>green<span class="punctuation token">,</span> red 30%<span class="punctuation token">,</span> red 40%<span class="punctuation token">,</span> pink<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h3 id="system-ui-font" tabindex="-1">system-ui font</h3> <p>The <code>system-ui</code> font allows you to use the operating system default font. When unsupported, Lightning CSS compiles it to a font stack that works across major platforms.</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">font-family</span><span class="punctuation token">:</span> system-ui<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <p>compiles to:</p> <pre class="language-css"><code class="language-css"><span class="selector token">.foo</span> <span class="punctuation token">{</span>
  <span class="property token">font-family</span><span class="punctuation token">:</span> system-ui<span class="punctuation token">,</span> -apple-system<span class="punctuation token">,</span> BlinkMacSystemFont<span class="punctuation token">,</span> Segoe UI<span class="punctuation token">,</span> Roboto<span class="punctuation token">,</span> Noto Sans<span class="punctuation token">,</span> Ubuntu<span class="punctuation token">,</span> Cantarell<span class="punctuation token">,</span> Helvetica Neue<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
</code></pre> <h2 id="draft-syntax" tabindex="-1">Draft syntax</h2> <p>Lightning CSS can also be configured to compile several draft specs that are not yet available natively in any browser. Because these are drafts and the syntax can still change, they must be enabled manually in your project.</p> <h3 id="custom-media-queries" tabindex="-1">Custom media queries</h3> <p>Support for <a href="https://drafts.csswg.org/mediaqueries-5/#custom-mq">custom media queries</a> is included in the Media Queries Level 5 draft spec. This allows you to define media queries that are reused in multiple places within a CSS file. Lightning CSS will perform this substitution ahead of time when this feature is enabled.</p> <p>For example:</p> <pre class="language-css"><code class="language-css"><span class="atrule token"><span class="rule token">@custom-media</span> --modern <span class="punctuation token">(</span>color<span class="punctuation token">)</span><span class="punctuation token">,</span> <span class="punctuation token">(</span>hover<span class="punctuation token">)</span><span class="punctuation token">;</span></span>

<span class="atrule token"><span class="rule token">@media</span> <span class="punctuation token">(</span>--modern<span class="punctuation token">)</span> <span class="keyword token">and</span> <span class="punctuation token">(</span>width > 1024px<span class="punctuation token">)</span></span> <span class="punctuation token">{</span>
  <span class="selector token">.a</span> <span class="punctuation token">{</span> <span class="property token">color</span><span class="punctuation token">:</span> green<span class="punctuation token">;</span> <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <p>is equivalent to:</p> <pre class="language-css"><code class="language-css"><span class="atrule token"><span class="rule token">@media</span> <span class="punctuation token">(</span><span class="punctuation token">(</span>color<span class="punctuation token">)</span> <span class="keyword token">or</span> <span class="punctuation token">(</span>hover<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="keyword token">and</span> <span class="punctuation token">(</span>width > 1024px<span class="punctuation token">)</span></span> <span class="punctuation token">{</span>
  <span class="selector token">.a</span> <span class="punctuation token">{</span> <span class="property token">color</span><span class="punctuation token">:</span> green<span class="punctuation token">;</span> <span class="punctuation token">}</span>
<span class="punctuation token">}</span>
</code></pre> <p>Because custom media queries are a draft, they are not enabled by default. To use them, enable the <code>customMedia</code> option under <code>drafts</code> when calling the Lightning CSS API. When using the CLI, enable the <code>--custom-media</code> flag.</p> <pre class="language-js"><code class="language-js"><span class="keyword token">let</span> <span class="punctuation token">{</span> code<span class="punctuation token">,</span> map <span class="punctuation token">}</span> <span class="operator token">=</span> <span class="function token">transform</span><span class="punctuation token">(</span><span class="punctuation token">{</span>
  <span class="comment token">// ...</span>
  <span class="literal-property property token">drafts</span><span class="operator token">:</span> <span class="punctuation token">{</span>
    <span class="literal-property property token">customMedia</span><span class="operator token">:</span> <span class="boolean token">true</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
</code></pre> <h2 id="pseudo-class-replacement" tabindex="-1">Pseudo class replacement</h2> <p>Lightning CSS supports replacing CSS pseudo classes such as <code>:focus-visible</code> with normal CSS classes that can be applied using JavaScript. This makes it possible to polyfill these pseudo classes for older browsers.</p> <pre class="language-js"><code class="language-js"><span class="keyword token">let</span> <span class="punctuation token">{</span> code<span class="punctuation token">,</span> map <span class="punctuation token">}</span> <span class="operator token">=</span> <span class="function token">transform</span><span class="punctuation token">(</span><span class="punctuation token">{</span>
  <span class="comment token">// ...</span>
  <span class="literal-property property token">pseudoClasses</span><span class="operator token">:</span> <span class="punctuation token">{</span>
    <span class="literal-property property token">focusVisible</span><span class="operator token">:</span> <span class="string token">'focus-visible'</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
</code></pre> <p>The above configuration will result in the <code>:focus-visible</code> pseudo class in all selectors being replaced with the <code>.focus-visible</code> class. This enables you to use a JavaScript <a href="https://github.com/WICG/focus-visible">polyfill</a>, which will apply the <code>.focus-visible</code> class as appropriate.</p> <p>The following pseudo classes may be configured as shown above:</p> <ul> <li><code>hover</code> – corresponds to the <code>:hover</code> pseudo class</li> <li><code>active</code> – corresponds to the <code>:active</code> pseudo class</li> <li><code>focus</code> – corresponds to the <code>:focus</code> pseudo class</li> <li><code>focusVisible</code> – corresponds to the <code>:focus-visible</code> pseudo class</li> <li><code>focusWithin</code> – corresponds to the <code>:focus-within</code> pseudo class</li> </ul> <h2 id="non-standard-syntax" tabindex="-1">Non-standard syntax</h2> <p>For compatibility with other tools, Lightning CSS supports parsing some non-standard CSS syntax. This must be enabled by turning on a flag under the <code>nonStandard</code> option.</p> <pre class="language-js"><code class="language-js"><span class="keyword token">let</span> <span class="punctuation token">{</span> code<span class="punctuation token">,</span> map <span class="punctuation token">}</span> <span class="operator token">=</span> <span class="function token">transform</span><span class="punctuation token">(</span><span class="punctuation token">{</span>
  <span class="comment token">// ...</span>
  <span class="literal-property property token">nonStandard</span><span class="operator token">:</span> <span class="punctuation token">{</span>
    <span class="literal-property property token">deepSelectorCombinator</span><span class="operator token">:</span> <span class="boolean token">true</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>

</code></pre> <p>Currently the following features are supported:</p> <ul> <li><code>deepSelectorCombinator</code> – enables parsing the Vue/Angular <code>&gt;&gt;&gt;</code> and <code>/deep/</code> selector combinators.</li> </ul> </main> <footer> Copyright © 2022 Devon Govett and Parcel Contributors. </footer> <script async src="rust-less/bundling.a1401b31.js"></script> </body></html>